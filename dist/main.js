(()=>{function o(){return h(f,null,h("div",null,"\u63D2\u4EF6\u6E90\u7801\u5730\u5740\u8BF7\u70B9\u51FB\u4E0B\u65B9\u94FE\u63A5\u67E5\u770B\uFF1A\u{1F680}"),h("a",{href:"https://github.com/Peanut086/WebAudioSpectrum"},"\u70B9\u6211\u53BBGithub"))}var s=class{constructor(e,n){this._analyser=e,this._ctx=n,this._bufferLength=this._analyser.frequencyBinCount,this._dataArray=new Uint8Array(this._bufferLength),this._analyser.fftSize=1024}drawBar(){requestAnimationFrame(this.drawBar.bind(this)),this._analyser.getByteFrequencyData(this._dataArray),this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.fillStyle="rgba(0, 0, 0, .1)",this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height);let e=this._ctx.canvas.width/this._bufferLength*14,n=0;for(let r=0;r<this._bufferLength;r++){let i=this._dataArray[r],c=this._ctx.createRadialGradient(this._ctx.canvas.width/2,this._ctx.canvas.height/2,0,this._ctx.canvas.width/2,this._ctx.canvas.height/2,this._ctx.canvas.width/2);c.addColorStop(0,"rgba(76, 235, 247, 0.1)"),c.addColorStop(1,`rgba(76, 235, 247, ${i/800})`),this._ctx.fillStyle=c,this._ctx.fillRect(n,this._ctx.canvas.height-i,e,i),n+=e+1}}};plugin.onConfig(()=>{let a=document.createElement("div");return ReactDOM.render(o(),a),a});var t=document.createElement("canvas");t.width=window.innerWidth;t.height=window.innerHeight;t.style.position="absolute";t.style.top="0";t.style.left="50%";t.style.transform="translateX(-50%)";t.style.zIndex="1";t.style.pointerEvents="none";var d,l=t.getContext("2d");plugin.onLoad(a=>{betterncm.utils.waitForElement(".g-single").then(e=>{e.appendChild(t),window.onresize=()=>{t.width=window.innerWidth,t.height=window.innerHeight}}),betterncm.utils.waitForElement(".btnp").then(e=>{loadedPlugins.LibFrontendPlay.addEventListener("updateCurrentAudioPlayer",n=>{let i=n.currentTarget.currentAudioAnalyser;d=new s(i,l),d.drawBar()})})});})();
